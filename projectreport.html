

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>UncoverML Project Report (NICTA) &mdash; UncoverML 0.3.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="uncoverml" href="modules.html" />
    <link rel="prev" title="Models" href="models.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> UncoverML
          

          
          </a>

          
            
            
              <div class="version">
                0.3.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command Line Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="workflows.html">Workflows</a></li>
<li class="toctree-l1"><a class="reference internal" href="models.html">Models</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">NICTA Project Report</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#revrand-large-scale-approximate-gaussian-processes">Revrand - large-scale approximate Gaussian processes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#heterogeneous-drill-observations">Heterogeneous drill observations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">UncoverML API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">History</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">UncoverML</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>UncoverML Project Report (NICTA)</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/projectreport.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="uncoverml-project-report-nicta">
<h1><a class="toc-backref" href="#id7">UncoverML Project Report (NICTA)</a><a class="headerlink" href="#uncoverml-project-report-nicta" title="Permalink to this headline">¶</a></h1>
<p>This page contains a brief report of the work completed by NICTA (now
Data61) on some of the aspects of UncoverML not covered by the
documentation.</p>
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#uncoverml-project-report-nicta" id="id7">UncoverML Project Report (NICTA)</a></p>
<ul>
<li><p><a class="reference internal" href="#revrand-large-scale-approximate-gaussian-processes" id="id8">Revrand - large-scale approximate Gaussian processes</a></p></li>
<li><p><a class="reference internal" href="#heterogeneous-drill-observations" id="id9">Heterogeneous drill observations</a></p></li>
<li><p><a class="reference internal" href="#references" id="id10">References</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="revrand-large-scale-approximate-gaussian-processes">
<h2><a class="toc-backref" href="#id8">Revrand - large-scale approximate Gaussian processes</a><a class="headerlink" href="#revrand-large-scale-approximate-gaussian-processes" title="Permalink to this headline">¶</a></h2>
<p>The main algorithm used from <a class="reference external" href="http://github.com/NICTA/revrand">revrand</a> is the standard linear model for
regression. The aim is to learn a function that maps input covariate values,
<span class="math notranslate nohighlight">\(\mathbf{x}_n \in \mathbb{R}^d\)</span>, to target values, <span class="math notranslate nohighlight">\(y_n \in
\mathbb{R}\)</span>. That is, learn <span class="math notranslate nohighlight">\(f\)</span> such that <span class="math notranslate nohighlight">\(y_n = f(\mathbf{x}_n) +
\epsilon\)</span>, where <span class="math notranslate nohighlight">\(\epsilon\)</span> is random (Gaussian) noise. The standard
linear model represents <span class="math notranslate nohighlight">\(f\)</span> as a linear combination of (non-linear)
<em>basis</em> functions, <span class="math notranslate nohighlight">\(f(\mathbf{x}_n) = \phi(\mathbf{x}_n, \theta)^\top
\mathbf{w}\)</span>, where <span class="math notranslate nohighlight">\(\phi: d \to D\)</span>, with weights <span class="math notranslate nohighlight">\(\mathbf{w} \in
\mathbb{R}^D\)</span>. The exact form of the model implemented in revrand is,</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\text{Likelihood:}&amp; \quad
\mathbf{y} \sim \prod^N_{n=1} \mathcal{N}(\phi(\mathbf{x}_n)^\top
    \mathbf{w}, \sigma^2),\\\text{Prior:}&amp; \quad
\mathbf{w} \sim \mathcal{N}(\mathbf{0}, \lambda \mathbf{I}_D),\end{aligned}\end{align} \]</div>
<p>We then maximise the <em>log marginal likelihood</em> of the model to learn the
parameters <span class="math notranslate nohighlight">\(\sigma^2, \lambda\)</span> and <span class="math notranslate nohighlight">\(\theta\)</span> from the data (without
over fitting). We can then solve for the posterior over the weights,</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\mathbf{w} | \mathbf{y}, \mathbf{X} \sim&amp; \mathcal{N}(\mathbf{m},
    \mathbf{C}),\\\mathbf{C} =&amp; [\lambda^{-1}\mathbf{I}_D + \sigma^{-2}\phi(\mathbf{X})^\top
    \phi(\mathbf{X})]^{-1},\\\mathbf{m} =&amp; \frac{1}{\sigma^2} \mathbf{C} \phi(\mathbf{X})^\top
    \mathbf{y}.\end{aligned}\end{align} \]</div>
<p>The predictive distribution given a query point, <span class="math notranslate nohighlight">\(\mathbf{x}^*\)</span> is,</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}p(y^*|\mathbf{x}^*, \mathbf{y}, \mathbf{X}) =&amp; \int
    \mathcal{N}(y^* | \phi(\mathbf{x}^*)^\top \mathbf{w}, \sigma^2)
    \mathcal{N}(\mathbf{w} | \mathbf{m}, \mathbf{C}) d\mathbf{w}\\    =&amp; \mathcal{N}\!\left(y^* | \phi(\mathbf{x}^*)^\top \mathbf{m},
        \sigma^2 + \phi(\mathbf{x}^*)^\top \mathbf{C} \phi(\mathbf{x}^*)
        \right).\end{aligned}\end{align} \]</div>
<p>This model can learn from large datasets, unlike a Gaussian process, which
needs to invert a matrix the dimension of the learning dataset. A Gaussian
process is in general more flexible than the above model, as it specifies a
prior directly over functions as opposed to weights (<span class="math notranslate nohighlight">\(\mathbf{f} \sim
\mathcal{N}(\mathbf{0}, \mathbf{K})\)</span>, where <span class="math notranslate nohighlight">\(\mathbf{K}\)</span> is a kernel
matrix). However, the trick implemented in revrand is that by choosing special
types of basis functions (<span class="math notranslate nohighlight">\(\phi(\cdot)\)</span>) we can approximate the behaviour
of Gaussian processes.  See <a class="footnote-reference brackets" href="#id3" id="id1">1</a> and <a class="footnote-reference brackets" href="#id4" id="id2">2</a> for more information.</p>
<p>We can also use this model to estimate the expected reduction in entropy of the
posterior distribution over the weights from incorporating a query point into
the model,</p>
<div class="math notranslate nohighlight">
\[H[\mathbf{w}] - H[\mathbf{w}|\mathbf{x}^*] = \frac{1}{2} \left[
    \log \left( \sigma^2
    + \phi(\mathbf{x}^*)^\top \mathbf{C} \phi(\mathbf{x}^*) \right)
    - \log(\sigma^2) \right]\]</div>
<p>This will tell us where to take future measurements to maximally reduce the
model uncertainty. It is worth noting that this quantity is very similar to the
predictive variance.</p>
</div>
<div class="section" id="heterogeneous-drill-observations">
<h2><a class="toc-backref" href="#id9">Heterogeneous drill observations</a><a class="headerlink" href="#heterogeneous-drill-observations" title="Permalink to this headline">¶</a></h2>
<p>While we did not have time to implement an algorithm to use heterogeneous drill
holes types, i.e. those that do and do not hit the basement, we did establish a
model for incorporating these observations. The basis for this model is a
conditional likelihood model that changes the distribution used depending on
the type of drill hole.</p>
<p>The purpose of a likelihood model is to model the process arising from
measurement error, that is, what is the probability of a measurement given the
true value? In this instance the true value is the depth of the basement,
<span class="math notranslate nohighlight">\(f_n\)</span>, at a point <span class="math notranslate nohighlight">\(n\)</span>, we then acquire a noisy measurement of this
basement from our drill-rig, <span class="math notranslate nohighlight">\(y_n\)</span>. The likelihood model then describes
the probability <span class="math notranslate nohighlight">\(p(y_n | f_n)\)</span>.</p>
<p>In this situation we have effectively two different methods of acquiring
measurements, direct observations of the basement layer, and a depth that we
know the basement must lie below. Hence, we need different likelihood models
for each of these “sensors”. For the first, where the drill has hit basement,
we can simply use a Gaussian measurement error model. For the second, we know
that there is non-zero probability of the drill encountering basement between
the ground, and the basement. We don’t know the reason for stopping the
drilling before the basement, and so we can put a uniform distribution on this
measurement between the surface and the basement. However we know that we are
unlikely to drill past the basement (otherwise this is the first type of
measurement), and so we put a steep Gaussian falloff after the basement layer,
as we have depicted in the following image</p>
<img alt="_images/comp_likelihood.svg" src="_images/comp_likelihood.svg" /><p>The formulation of the actual likelihood and prior is as follows, recall
<span class="math notranslate nohighlight">\(f_n := f(\mathbf{x}_n) = \phi(\mathbf{x}_n)^\top \mathbf{w}\)</span>,</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\text{Likelihood:}&amp; \quad
\mathbf{y} | \mathbf{z}, \mathbf{w} \sim \prod^N_{n=1}
        \mathcal{N}(f_n, \sigma^2)^{z_n}
        p_{z_n=0}(f_n, l^2)^{1 - z_n},\\\text{Prior:}&amp; \quad
\mathbf{w} \sim \mathcal{N}(\mathbf{0}, \lambda \mathbf{I}_D).\end{aligned}\end{align} \]</div>
<p>Here <span class="math notranslate nohighlight">\(z_n\)</span> is an indicator variable that is 1 if an observation has hit
the basement, and so uses a Gaussian measurement error model, or 0 if the
basement was not hit, and so uses a piecewise modified uniform measurement
model,</p>
<div class="math notranslate nohighlight">
\[\begin{split}p_{z_n=0}(y_n | f_n, l^2) =
\begin{cases}
\frac{1}{f_n + l \sqrt{(\pi/2)}}
    &amp; \text{if}~y_n \leq f_n~\text{and}~f_n &gt; 0, \\
\frac{1}{f_n + l \sqrt{(\pi/2)}} e^{-\frac{(y_n - f_n)^2}{2 l^2}}
    &amp; \text{if}~y_n &gt; f_n~\text{and}~f_n &gt; 0, \\
\frac{1}{l \sqrt{(\pi/2)}} e^{-\frac{(y_n - f_n)^2}{2 l^2}}
    &amp; \text{if}~f &lt; 0.
\end{cases}\end{split}\]</div>
<p>The first condition models the case where the observation occurs above the
basement (most likely scenario). The second condition models the case where the
basement is above the measurement, which is very unlikely. The third condition
models the case where the basement is above the surface and our observation is
below the surface. Again this condition is very unlikely, but it is included in
the likelihood mainly as a way to constrain inference of <span class="math notranslate nohighlight">\(f_n\)</span> to be
below the surface and below <span class="math notranslate nohighlight">\(y_n\)</span>. Here <span class="math notranslate nohighlight">\(l\)</span> is a scale parameter
which is set a-priori to penalise the model for placing the basement above
observations that do not impact the basement.</p>
<p>Inference in this model is more difficult than in the standard linear model,
however there is an implementation of a <em>generalised</em> linear model in revrand,
that can be easily extended to use this compound likelihood.</p>
</div>
<div class="section" id="references">
<h2><a class="toc-backref" href="#id10">References</a><a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<dl class="footnote brackets">
<dt class="label" id="id3"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>Yang, Z., Smola, A. J., Song, L., &amp; Wilson, A. G. “A la Carte –
Learning Fast Kernels”. Proceedings of the Eighteenth International
Conference on Artificial Intelligence and Statistics, pp. 1098-1106,
2015.</p>
</dd>
<dt class="label" id="id4"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>Rasmussen, C. E., &amp; Williams, C. K. I. “Gaussian Processes for Machine
Learning”, MIT Press, 2006.</p>
</dd>
<dt class="label" id="id5"><span class="brackets">3</span></dt>
<dd><p>Rahimi, A., &amp; Recht, B. “Random features for large-scale kernel
machines.” Advances in neural information processing systems. 2007.</p>
</dd>
<dt class="label" id="id6"><span class="brackets">4</span></dt>
<dd><p>Gershman, S., Hoffman, M., &amp; Blei, D. “Nonparametric variational
inference”. arXiv preprint arXiv:1206.4665 (2012).</p>
</dd>
</dl>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="modules.html" class="btn btn-neutral float-right" title="uncoverml" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="models.html" class="btn btn-neutral float-left" title="Models" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Geoscience Australia

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>